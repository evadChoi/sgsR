load_all()
subset = 0.5
paste0("'subset' was specified. Taking", subset * 100, " % of available pixels to determine OSB")
message(paste0("'subset' was specified. Taking ", subset * 100, "% of available pixels to determine OSB"))
subset = 0.46789
message(paste0("'subset' was specified. Taking ", subset * 100, "% of available pixels to determine OSB"))
subset = 2
if (subset > 1 | subset < 0)
stop("'subset' must be between 0 and 1")
load_all()
strat_metrics(wall_poly, b = 2)
load_all()
strat_metrics(wall_poly, b = 2)
wall_poly
strat_metrics(wall_poly, metric = "wal_1" b = 2)
strat_metrics(wall_poly, metric = "wal_1", b = 2)
strat_metrics(wall_poly[[1], b = 2)
strat_metrics(wall_poly[[1]], b = 2)
mraster <- wall_poly[[1]]
terra::values(mraster)
head(terra::values(mraster) )
load_all()
strat_metrics(wall_poly[[1]], b = 2)
load_all()
strat_metrics(wall_poly[[1]], b = 2)
plot(strat_metrics(wall_poly[[1]], b = 2))
plot(strat_metrics(wall_poly[[1]], b = 5))
plot(strat_metrics(wall_poly[[1]], b = 10))
check()
check()
document()
help(strat_pcomp)
document()
help(strat_pcomp)
document()
help(strat_pcomp)
check()
use_r("sample_strat")
document()
help(sample_strat)
load_all()
document()
help(sample_strat)
help(sgsR::sample_strat)
document()
load_all()
help(sample_strat)
document()
load_all()
load_all()
document()
help(sample_strat)
load()
load_all()
document()
library(sgsR)
library(terra)
library(sf)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(ggplot2)
library(spatstat)
#--- import ALS metrics raster ---#
raster <- terra::rast(system.file("extdata", "wall_metrics_small.tif", package = "sgsR"))
#--- import forest inventory polygon and mask unwanted areas ---#
poly <- sf::st_read(system.file("extdata", "inventory_polygons.shp", package = "sgsR"))
#--- import access layer to be used during sampling if desired ---#
roads <- sf::st_read(system.file("extdata", "roads.shp", package = "sgsR"))
#--- manipulate inventory polygon to mask out unwanted areas ---#
poly_subset <- poly[poly$POLYTYPE == "FOR" & poly$OWNER == 1, ]
poly_subset <- sf::st_union(poly_subset)
poly_subset <- terra::vect(poly_subset)
#--- mask input ALS raster using polygon layer ---#
wall_poly <- terra::mask(raster,
poly_subset)
plot(wall_poly[[1:3]])
#--- perform stratification using k-means ---#
kmeans <- strat_kmeans(mraster = wall_poly[[5]],
nstrata = 4)
plot(kmeans)
#--- output details related to kmeans algorithm ---#
kmeansd <- strat_kmeans(mraster = wall_poly[[5]],
nstrata = 4,
details = TRUE)
kmeansd$details
#--- perform stratification using k-means ---#
kmeans <- strat_kmeans(mraster = wall_poly[[5]],
nstrata = 4)
plot(kmeans)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
#--- perform stratification using principal components ---#
pcomp <- strat_pcomp(mraster = wall_poly,
nstrata = 4,
nstrata2 = 3)
plot(pcomp)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
#--- perform stratification using principal components on P1 only ---#
pcomp1 <- strat_pcomp(mraster = wall_poly,
nstrata = 4)
plot(pcomp1)
#--- perform stratification using principal components on P1 and P2 ---#
pcomp2 <- strat_pcomp(mraster = wall_poly,
nstrata = 4,
nstrata2 = 3)
#--- number of components will always be equal to 'nstrata' * 'nstrata2' (if 'nstrata2' is provided) ---#
plot(pcomp2)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
#--- perform stratification using an individual metric ---#
#--- if no 'metric' name defined and raster is 1 layer - automatically uses only available layer ---#
metrics1 <- strat_metrics(mraster = wall_poly[[1]],
nstrata = 5)
plot(metrics1)
#--- perform stratification using an individual metric ---#
metrics2 <- strat_metrics(mraster = wall_poly,
metric = "wal_5",
nstrata = 10)
plot(metrics2)
#--- perform stratification using 2 metrics metrics ---#
metrics3 <- strat_metrics(mraster = wall_poly,
metric = "wal_5",
metric2 = "wal_2",
nstrata = 10,
nstrata2 = 5)
plot(metrics3)
#--- define desired stratification raster ---#
raster <- kmeans
#--- 'mindist' between samples defaults to 100 ---#
srs_wo <- sample_srs(sraster = raster,
n = 50)
srs_wo
#--- define desired stratification raster ---#
raster <- kmeans
#--- sampling **without** access defined---#
#--- 'mindist' between samples defaults to 100 ---#
srs_wo <- sample_srs(sraster = raster,
n = 50)
plot(raster)
plot(srs_wo,add = T, col= "Black")
load_all()
document()
help(extract_existing)
document()
#--- import ALS metrics raster ---#
raster <- terra::rast(system.file("extdata", "wall_metrics_small.tif", package = "sgsR"))
#--- import forest inventory polygon and mask unwanted areas ---#
poly <- sf::st_read(system.file("extdata", "inventory_polygons.shp", package = "sgsR"))
#--- import access layer to be used during sampling if desired ---#
roads <- sf::st_read(system.file("extdata", "roads.shp", package = "sgsR"))
#--- manipulate inventory polygon to mask out unwanted areas ---#
poly_subset <- poly[poly$POLYTYPE == "FOR" & poly$OWNER == 1, ]
poly_subset <- sf::st_union(poly_subset)
poly_subset <- terra::vect(poly_subset)
#--- mask input ALS raster using polygon layer ---#
wall_poly <- terra::mask(raster,
poly_subset)
plot(wall_poly[[1:3]])
#--- perform stratification using k-means ---#
kmeans <- strat_kmeans(mraster = wall_poly[[5]],
nstrata = 4)
plot(kmeans)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
#--- perform stratification using principal components on P1 only ---#
pcomp1 <- strat_pcomp(mraster = wall_poly,
nstrata = 4)
plot(pcomp1)
#--- perform stratification using principal components on P1 and P2 ---#
pcomp2 <- strat_pcomp(mraster = wall_poly,
nstrata = 4,
nstrata2 = 3)
#--- number of output strata will always be equal to ---#
#--- 'nstrata' * 'nstrata2' (if 'nstrata2' is provided) ---#
plot(pcomp2)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
#--- perform stratification using principal components on P1 only ---#
pcomp1 <- strat_pcomp(mraster = wall_poly,
nstrata = 4)
plot(pcomp1)
#--- perform stratification using principal components on P1 and P2 ---#
pcomp2 <- strat_pcomp(mraster = wall_poly,
nstrata = 4,
nstrata2 = 3)
#--- number of output strata will always be equal to ---#
#--- 'nstrata' * 'nstrata2' (if 'nstrata2' is provided) ---#
plot(pcomp2)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
#--- perform stratification using an individual metric ---#
#--- if no 'metric' name defined and raster is 1 layer - automatically uses only available layer ---#
metrics1 <- strat_metrics(mraster = wall_poly[[1]],
nstrata = 5)
plot(metrics1)
#--- perform stratification using an individual metric ---#
metrics2 <- strat_metrics(mraster = wall_poly,
metric = "wal_5",
nstrata = 10)
plot(metrics2)
#--- perform stratification using 2 metrics metrics ---#
metrics3 <- strat_metrics(mraster = wall_poly,
metric = "wal_5",
metric2 = "wal_2",
nstrata = 10,
nstrata2 = 5)
plot(metrics3)
#--- number of output strata will always be equal to ---#
#--- 'nstrata' * 'nstrata2' (if 'nstrata2' is provided) ---#
#--- define desired stratification raster ---#
sraster <- kmeans
#--- SRS **without** access defined---#
#--- 'mindist' between samples defaults to 100 ---#
srs_wo <- sample_srs(sraster = sraster,
n = 50)
plot(sraster)
plot(srs_wo,add = T, col= "Black")
#--- change mindist parameter ---#
srs_md <- sample_srs(sraster = sraster,
n = 50,
mindist = 200)
plot(sraster)
plot(srs_md,add = T, col= "Black")
#--- sampling **with** access defined---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also speficy we want an external buffer ('buff_outer') of 200 ---#
srs_w <- sample_srs(sraster = sraster,
n = 200,
mindist = 200,
access = roads,
buff_inner = 50,
buff_outer = 200)
plot(sraster)
plot(srs_w,add = T, col= "Black")
#--- sampling **with** access defined---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also speficy we want an external buffer ('buff_outer') of 200 ---#
srs_w <- sample_srs(sraster = sraster,
n = 200,
mindist = 200,
access = roads,
buff_inner = 50,
buff_outer = 200)
load_all()
document()
help(sample_strat)
load_all()
#--- sampling **with** access defined---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also speficy we want an external buffer ('buff_outer') of 200 ---#
srs_w <- sample_srs(sraster = sraster,
n = 200,
mindist = 200,
access = roads,
buff_inner = 50,
buff_outer = 200)
#--- sampling **with** access defined---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also speficy we want an external buffer ('buff_outer') of 200 ---#
srs_w <- sample_srs(sraster = sraster,
n = 200,
mindist = 200,
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- stratified sampling **without** access defined---#
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
#--- change mindist parameter ---#
strat_md <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
plot = TRUE)
#--- extract strata from raster for already existing sample network ---#
#--- we use random samples defined above ---#
existing <- extract_existing(sraster = sraster,
existing = srs_wo)
existing
#--- if 'data.frame = TRUE -- output will be a dataframe instead of an sf object ---#
#--- sampling **with** access defined **and** existing samples defined ---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we specify we have an existing plot network to include in our sampling ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also specify we want an external buffer ('buff_outer') of 200 ---#
strat_w_e <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
strat_w_e
#--- sampling **with** access defined **and** existing samples defined ---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we specify we have an existing plot network to include in our sampling ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also specify we want an external buffer ('buff_outer') of 200 ---#
strat_w_e_i <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
include = TRUE, #--- including our existing plots to reach 200 samples ---#
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- how many samples did we get total? ---#
strat_w_e_i
load_all()
strat_w_e_i <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
include = TRUE, #--- including our existing plots to reach 200 samples ---#
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- stratified sampling with access and buffers provided ---#
strat_w_a <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- extract strata from raster for already existing sample network ---#
#--- we use random samples defined above ---#
existing <- extract_existing(sraster = sraster,
existing = srs_wo)
existing
#--- if 'data.frame = TRUE -- output will be a dataframe instead of an sf object ---#
#--- sampling **with** access defined **and** existing samples defined ---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we specify we have an existing plot network to include in our sampling ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also specify we want an external buffer ('buff_outer') of 200 ---#
strat_w_e <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- how many samples did we get total? ---#
strat_w_e
#--- sampling **with** access defined **and** existing samples defined ---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we specify we have an existing plot network to include in our sampling ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also specify we want an external buffer ('buff_outer') of 200 ---#
strat_w_e_i <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
include = TRUE, #--- including our existing plots to reach 200 samples ---#
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- how many samples did we get total? ---#
strat_w_e_i
#--- extract metrics from multi-band ALS raster for potential modeling ---#
metrics <- extract_metrics(sraster = wall_poly,
samples = strat_w_ei)
#--- extract metrics from multi-band ALS raster for potential modeling ---#
metrics <- extract_metrics(sraster = wall_poly,
samples = strat_w_e_i)
metrics
#--- if 'data.frame = TRUE -- output will be a dataframe instead of an sf object ---#
system.file("extdata", "wall_metrics_small.tif", package = "sgsR")
#--- perform stratification using k-means ---#
kmeans <- strat_kmeans(mraster = wall_poly[[5]],
nstrata = 4)
plot(kmeans)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
load_all()
check()
load_all()
check()
#--- stratified sampling **without** access defined---#
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
sraster
library(terra)
help(terra::mask)
help(mask)
load_all()
check()
sraster
#--- stratified sampling **without** access defined---#
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
#--- stratified sampling **without** access defined---#
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200)
load_all()
load_all()
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200)
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
strat_wo
load_all()
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
suppressWarnings(terra::plot(samples, add = T, col = ifelse(samples$type=="existing","Red","Black")),)
load_all()
#--- 'mindist' between samples defaults to 100 ---#
strat_wo <- sample_strat(sraster = sraster,
n = 200,
plot = TRUE)
#--- change mindist parameter ---#
strat_md <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
plot = TRUE)
#--- stratified sampling with access and buffers provided ---#
strat_w_a <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- extract strata from raster for already existing sample network ---#
#--- we use random samples defined above ---#
existing <- extract_existing(sraster = sraster,
existing = srs_wo)
existing
#--- if 'data.frame = TRUE -- output will be a dataframe instead of an sf object ---#
#--- sampling **with** access defined **and** existing samples defined ---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we specify we have an existing plot network to include in our sampling ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also specify we want an external buffer ('buff_outer') of 200 ---#
strat_w_e <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- how many samples did we get total? ---#
strat_w_e
#--- sampling **with** access defined **and** existing samples defined ---#
#--- we want 200 samples with 200m min distance between each ---#
#--- we specify we have an existing plot network to include in our sampling ---#
#--- we also provide an `access` polygon, which is linear road features ---#
#--- we specify we want an internal buffer ('buff_inner') of 50 ---#
#--- we also specify we want an external buffer ('buff_outer') of 200 ---#
strat_w_e_i <- sample_strat(sraster = sraster,
n = 200,
mindist = 200,
existing = existing,
include = TRUE, #--- including our existing plots to reach 200 samples ---#
access = roads,
buff_inner = 50,
buff_outer = 200,
plot = TRUE)
#--- how many samples did we get total? ---#
strat_w_e_i
#--- extract metrics from multi-band ALS raster for potential modeling ---#
metrics <- extract_metrics(sraster = wall_poly,
samples = strat_w_e_i)
metrics
#--- if 'data.frame = TRUE -- output will be a dataframe instead of an sf object ---#
check()
#--- perform stratification using k-means ---#
kmeans <- strat_kmeans(mraster = wall_poly[[5]],
nstrata = 4)
plot(kmeans)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
wall_poly[[5]]
#--- perform stratification using k-means ---#
kmeans <- strat_kmeans(mraster = wall_poly[[5]], nstrata = 4)
plot(kmeans)
#--- set 'details' = TRUE to get algorithm details and outputs ---#
load_all()
rmarkdown::render('sgsR.vignette.Rmd', output_format = 'html_document')
rmarkdown::render('vignettes/sgsR.vignette.Rmd', output_format = 'html_document')
rmarkdown::render('vignettes/sgsR-vignette.Rmd', output_format = 'html_document')
strat_kmeans(wall_poly[[5]],4)
strat_kmeans(wall_poly[[5]],nstrata=4)
